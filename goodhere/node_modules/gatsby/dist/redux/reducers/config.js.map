{"version":3,"sources":["../../../src/redux/reducers/config.js"],"names":["chalk","require","gatsbyConfigSchema","module","exports","state","action","type","result","validate","payload","normalizedPayload","value","error","console","log","blue","bgYellow","bold","red","linkPrefix","Error"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,OAAF,CAArB;;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAyBD,OAAO,CAAE,uBAAF,CAAtC;;AAEAE,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,iBAAN;AAAwB;AACtB;AACA,cAAMC,MAAM,GAAGN,kBAAkB,CAACO,QAAnB,CAA4BH,MAAM,CAACI,OAAP,IAAkB,EAA9C,CAAf;AAEA,cAAMC,iBAAiB,GAAGH,MAAM,CAACI,KAAjC,CAJsB,CAMtB;AACA;AACA;;AACA,YAAIJ,MAAM,CAACK,KAAX,EAAkB;AAChBC,UAAAA,OAAO,CAACC,GAAR,CACEf,KAAK,CAACgB,IAAN,CAAWC,QAAX,CAAqB,+CAArB,CADF;AAGAH,UAAAA,OAAO,CAACC,GAAR,CAAYf,KAAK,CAACkB,IAAN,CAAWC,GAAX,CAAeX,MAAM,CAACK,KAAtB,CAAZ;;AACA,cAAIF,iBAAiB,CAACS,UAAtB,EAAkC;AAChCN,YAAAA,OAAO,CAACC,GAAR,CAAa,gDAAb;AACD;;AACD,gBAAM,IAAIM,KAAJ,CAAW,+CAAX,CAAN;AACD;;AAED,eAAOV,iBAAP;AACD;;AACD;AACE,aAAON,KAAP;AAxBJ;AA0BD,CA3BD","sourcesContent":["const chalk = require(`chalk`)\n\nconst { gatsbyConfigSchema } = require(`../../joi-schemas/joi`)\n\nmodule.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_SITE_CONFIG`: {\n      // Validate the config.\n      const result = gatsbyConfigSchema.validate(action.payload || {})\n\n      const normalizedPayload = result.value\n\n      // TODO use Redux for capturing errors from different\n      // parts of Gatsby so a) can capture richer errors and b) be\n      // more flexible how to display them.\n      if (result.error) {\n        console.log(\n          chalk.blue.bgYellow(`The site's gatsby-config.js failed validation`)\n        )\n        console.log(chalk.bold.red(result.error))\n        if (normalizedPayload.linkPrefix) {\n          console.log(`\"linkPrefix\" should be changed to \"pathPrefix\"`)\n        }\n        throw new Error(`The site's gatsby-config.js failed validation`)\n      }\n\n      return normalizedPayload\n    }\n    default:\n      return state\n  }\n}\n"],"file":"config.js"}