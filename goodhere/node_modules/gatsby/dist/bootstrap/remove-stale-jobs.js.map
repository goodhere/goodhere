{"version":3,"sources":["../../src/bootstrap/remove-stale-jobs.js"],"names":["isJobStale","require","publicActions","internalActions","module","exports","state","actions","jobsV2","complete","forEach","job","contentDigest","push","removeStaleJob","incomplete","plugin","createJobV2"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAiBC,OAAO,CAAE,uBAAF,CAA9B;;AACA,MAAM;AAAEC,EAAAA,aAAF;AAAiBC,EAAAA;AAAjB,IAAqCF,OAAO,CAAE,kBAAF,CAAlD;;AAEAG,MAAM,CAACC,OAAP,GAAiBC,KAAK,IAAI;AACxB,QAAMC,OAAO,GAAG,EAAhB,CADwB,CAGxB;;AACAD,EAAAA,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,OAAtB,CAA8B,CAACC,GAAD,EAAMC,aAAN,KAAwB;AACpD,QAAIZ,UAAU,CAACW,GAAD,CAAd,EAAqB;AACnBJ,MAAAA,OAAO,CAACM,IAAR,CAAaV,eAAe,CAACW,cAAhB,CAA+BF,aAA/B,CAAb;AACD;AACF,GAJD,EAJwB,CAUxB;AACA;;AACAN,EAAAA,KAAK,CAACE,MAAN,CAAaO,UAAb,CAAwBL,OAAxB,CAAgC,CAAC;AAAEC,IAAAA,GAAF;AAAOK,IAAAA;AAAP,GAAD,KAAqB;AACnD,QAAIhB,UAAU,CAACW,GAAD,CAAd,EAAqB;AACnBJ,MAAAA,OAAO,CAACM,IAAR,CAAaV,eAAe,CAACW,cAAhB,CAA+BH,GAAG,CAACC,aAAnC,CAAb;AACD,KAFD,MAEO;AACLL,MAAAA,OAAO,CAACM,IAAR,CAAaX,aAAa,CAACe,WAAd,CAA0BN,GAA1B,EAA+BK,MAA/B,CAAb;AACD;AACF,GAND;AAQA,SAAOT,OAAP;AACD,CArBD","sourcesContent":["const { isJobStale } = require(`../utils/jobs-manager`)\nconst { publicActions, internalActions } = require(`../redux/actions`)\n\nmodule.exports = state => {\n  const actions = []\n\n  // If any of our finished jobs are stale we remove them to keep our cache small\n  state.jobsV2.complete.forEach((job, contentDigest) => {\n    if (isJobStale(job)) {\n      actions.push(internalActions.removeStaleJob(contentDigest))\n    }\n  })\n\n  // If any of our pending jobs do not have an existing inputPath or the inputPath changed\n  // we remove it from the queue as they would fail anyway\n  state.jobsV2.incomplete.forEach(({ job, plugin }) => {\n    if (isJobStale(job)) {\n      actions.push(internalActions.removeStaleJob(job.contentDigest))\n    } else {\n      actions.push(publicActions.createJobV2(job, plugin))\n    }\n  })\n\n  return actions\n}\n"],"file":"remove-stale-jobs.js"}