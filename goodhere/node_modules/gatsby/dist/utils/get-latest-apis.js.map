{"version":3,"sources":["../../src/utils/get-latest-apis.js"],"names":["path","require","fs","axios","API_FILE","ROOT","join","__dirname","OUTPUT_FILE","module","exports","getLatestAPI","data","get","timeout","writeFile","JSON","stringify","e","exists","readJSON","catch","browser","node","ssr"],"mappings":";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAE,OAAF,CAArB;;AAEA,MAAMG,QAAQ,GAAI,oCAAlB;AACA,MAAMC,IAAI,GAAGL,IAAI,CAACM,IAAL,CAAUC,SAAV,EAAsB,IAAtB,EAA4B,IAA5B,CAAb;AACA,MAAMC,WAAW,GAAGR,IAAI,CAACM,IAAL,CAAUD,IAAV,EAAiB,kBAAjB,CAApB;;AAEAI,MAAM,CAACC,OAAP,GAAiB,eAAeC,YAAf,GAA8B;AAC7C,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAW,MAAMT,KAAK,CAACU,GAAN,CAAUT,QAAV,EAAoB;AAAEU,MAAAA,OAAO,EAAE;AAAX,KAApB,CAAvB;AAEA,UAAMZ,EAAE,CAACa,SAAH,CAAaP,WAAb,EAA0BQ,IAAI,CAACC,SAAL,CAAeL,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAA1B,EAA0D,MAA1D,CAAN;AAEA,WAAOA,IAAP;AACD,GAND,CAME,OAAOM,CAAP,EAAU;AACV,QAAI,MAAMhB,EAAE,CAACiB,MAAH,CAAUX,WAAV,CAAV,EAAkC;AAChC,aAAON,EAAE,CAACkB,QAAH,CAAYZ,WAAZ,CAAP;AACD,KAHS,CAIV;;;AACA,WAAON,EAAE,CAACkB,QAAH,CAAYpB,IAAI,CAACM,IAAL,CAAUD,IAAV,EAAiB,WAAjB,CAAZ,EAA0CgB,KAA1C,CAAgD,MAAM;AAC3D,aAAO;AACLC,QAAAA,OAAO,EAAE,EADJ;AAELC,QAAAA,IAAI,EAAE,EAFD;AAGLC,QAAAA,GAAG,EAAE;AAHA,OAAP;AAKD,KANM,CAAP;AAOD;AACF,CApBD","sourcesContent":["const path = require(`path`)\nconst fs = require(`fs-extra`)\nconst axios = require(`axios`)\n\nconst API_FILE = `https://unpkg.com/gatsby/apis.json`\nconst ROOT = path.join(__dirname, `..`, `..`)\nconst OUTPUT_FILE = path.join(ROOT, `latest-apis.json`)\n\nmodule.exports = async function getLatestAPI() {\n  try {\n    const { data } = await axios.get(API_FILE, { timeout: 5000 })\n\n    await fs.writeFile(OUTPUT_FILE, JSON.stringify(data, null, 2), `utf8`)\n\n    return data\n  } catch (e) {\n    if (await fs.exists(OUTPUT_FILE)) {\n      return fs.readJSON(OUTPUT_FILE)\n    }\n    // possible offline/network issue\n    return fs.readJSON(path.join(ROOT, `apis.json`)).catch(() => {\n      return {\n        browser: {},\n        node: {},\n        ssr: {},\n      }\n    })\n  }\n}\n"],"file":"get-latest-apis.js"}