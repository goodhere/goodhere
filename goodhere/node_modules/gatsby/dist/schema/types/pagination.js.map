{"version":3,"sources":["../../../src/schema/types/pagination.js"],"names":["getFieldsEnum","require","addDerivedType","distinct","group","getPageInfo","schemaComposer","getOrCreateOTC","tc","addFields","currentPage","hasPreviousPage","hasNextPage","itemCount","pageCount","perPage","getEdge","typeComposer","typeName","getTypeName","derivedTypeName","next","node","getTypeNonNull","previous","createPagination","fields","paginationTypeComposer","totalCount","edges","nodes","pageInfo","makeFieldNonNull","getGroup","field","fieldValue","getPagination","inputTypeComposer","getInputTypeComposer","fieldsEnumTC","type","args","resolve","skip","limit","module","exports"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAoBC,OAAO,CAAE,QAAF,CAAjC;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAqBD,OAAO,CAAE,iBAAF,CAAlC;;AACA,MAAM;AAAEE,EAAAA,QAAF;AAAYC,EAAAA;AAAZ,IAAsBH,OAAO,CAAE,cAAF,CAAnC;;AAEA,MAAMI,WAAW,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAClBA,cAAc,CAACC,cAAf,CAA+B,UAA/B,EAA0CC,EAAE,IAAI;AAC9CA,EAAAA,EAAE,CAACC,SAAH,CAAa;AACXC,IAAAA,WAAW,EAAG,MADH;AAEXC,IAAAA,eAAe,EAAG,UAFP;AAGXC,IAAAA,WAAW,EAAG,UAHH;AAIXC,IAAAA,SAAS,EAAG,MAJD;AAKXC,IAAAA,SAAS,EAAG,MALD;AAMXC,IAAAA,OAAO,EAAG;AANC,GAAb;AAQD,CATD,CADF;;AAYA,MAAMC,OAAO,GAAG,CAAC;AAAEV,EAAAA,cAAF;AAAkBW,EAAAA;AAAlB,CAAD,KAAsC;AACpD,QAAMC,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,MAA/C;AACAjB,EAAAA,cAAc,CAAC;AAAEe,IAAAA,YAAF;AAAgBG,IAAAA,eAAe,EAAEF;AAAjC,GAAD,CAAd;AACA,SAAOZ,cAAc,CAACC,cAAf,CAA8BW,QAA9B,EAAwCV,EAAE,IAAI;AACnDA,IAAAA,EAAE,CAACC,SAAH,CAAa;AACXY,MAAAA,IAAI,EAAEJ,YADK;AAEXK,MAAAA,IAAI,EAAEL,YAAY,CAACM,cAAb,EAFK;AAGXC,MAAAA,QAAQ,EAAEP;AAHC,KAAb;AAKD,GANM,CAAP;AAOD,CAVD;;AAYA,MAAMQ,gBAAgB,GAAG,CAAC;AACxBnB,EAAAA,cADwB;AAExBW,EAAAA,YAFwB;AAGxBS,EAAAA,MAHwB;AAIxBR,EAAAA;AAJwB,CAAD,KAKnB;AACJ,QAAMS,sBAAsB,GAAGrB,cAAc,CAACC,cAAf,CAA8BW,QAA9B,EAAwCV,EAAE,IAAI;AAC3EA,IAAAA,EAAE,CAACC,SAAH,CAAa;AACXmB,MAAAA,UAAU,EAAG,MADF;AAEXC,MAAAA,KAAK,EAAE,CAACb,OAAO,CAAC;AAAEV,QAAAA,cAAF;AAAkBW,QAAAA;AAAlB,OAAD,CAAP,CAA0CM,cAA1C,EAAD,CAFI;AAGXO,MAAAA,KAAK,EAAE,CAACb,YAAY,CAACM,cAAb,EAAD,CAHI;AAIXQ,MAAAA,QAAQ,EAAE1B,WAAW,CAAC;AAAEC,QAAAA;AAAF,OAAD,CAAX,CAAgCiB,cAAhC,EAJC;AAKX,SAAGG;AALQ,KAAb;AAOD,GAR8B,CAA/B;AASAC,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACAL,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACA9B,EAAAA,cAAc,CAAC;AAAEe,IAAAA,YAAF;AAAgBG,IAAAA,eAAe,EAAEF;AAAjC,GAAD,CAAd;AACA,SAAOS,sBAAP;AACD,CAnBD;;AAqBA,MAAMM,QAAQ,GAAG,CAAC;AAAE3B,EAAAA,cAAF;AAAkBW,EAAAA;AAAlB,CAAD,KAAsC;AACrD,QAAMC,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,iBAA/C;AACA,QAAMO,MAAM,GAAG;AACbQ,IAAAA,KAAK,EAAG,SADK;AAEbC,IAAAA,UAAU,EAAG;AAFA,GAAf;AAIA,SAAOV,gBAAgB,CAAC;AAAEnB,IAAAA,cAAF;AAAkBW,IAAAA,YAAlB;AAAgCS,IAAAA,MAAhC;AAAwCR,IAAAA;AAAxC,GAAD,CAAvB;AACD,CAPD;;AASA,MAAMkB,aAAa,GAAG,CAAC;AAAE9B,EAAAA,cAAF;AAAkBW,EAAAA;AAAlB,CAAD,KAAsC;AAC1D,QAAMoB,iBAAiB,GAAGpB,YAAY,CAACqB,oBAAb,EAA1B;AACA,QAAMpB,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,YAA/C;AACA,QAAMoB,YAAY,GAAGvC,aAAa,CAAC;AACjCM,IAAAA,cADiC;AAEjCW,IAAAA,YAFiC;AAGjCoB,IAAAA;AAHiC,GAAD,CAAlC;AAKA,QAAMX,MAAM,GAAG;AACbvB,IAAAA,QAAQ,EAAE;AACRqC,MAAAA,IAAI,EAAE,CAAE,SAAF,CADE;AAERC,MAAAA,IAAI,EAAE;AACJP,QAAAA,KAAK,EAAEK,YAAY,CAAChB,cAAb;AADH,OAFE;AAKRmB,MAAAA,OAAO,EAAEvC;AALD,KADG;AAQbC,IAAAA,KAAK,EAAE;AACLoC,MAAAA,IAAI,EAAE,CAACP,QAAQ,CAAC;AAAE3B,QAAAA,cAAF;AAAkBW,QAAAA;AAAlB,OAAD,CAAR,CAA2CM,cAA3C,EAAD,CADD;AAELkB,MAAAA,IAAI,EAAE;AACJE,QAAAA,IAAI,EAAG,KADH;AAEJC,QAAAA,KAAK,EAAG,KAFJ;AAGJV,QAAAA,KAAK,EAAEK,YAAY,CAAChB,cAAb;AAHH,OAFD;AAOLmB,MAAAA,OAAO,EAAEtC;AAPJ;AARM,GAAf;AAkBA,QAAMuB,sBAAsB,GAAGF,gBAAgB,CAAC;AAC9CnB,IAAAA,cAD8C;AAE9CW,IAAAA,YAF8C;AAG9CS,IAAAA,MAH8C;AAI9CR,IAAAA;AAJ8C,GAAD,CAA/C;AAMAS,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,UAAzC;AACAL,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACA,SAAOL,sBAAP;AACD,CAnCD;;AAqCAkB,MAAM,CAACC,OAAP,GAAiB;AACfzC,EAAAA,WADe;AAEfW,EAAAA,OAFe;AAGfiB,EAAAA,QAHe;AAIfG,EAAAA;AAJe,CAAjB","sourcesContent":["const { getFieldsEnum } = require(`./sort`)\nconst { addDerivedType } = require(`./derived-types`)\nconst { distinct, group } = require(`../resolvers`)\n\nconst getPageInfo = ({ schemaComposer }) =>\n  schemaComposer.getOrCreateOTC(`PageInfo`, tc => {\n    tc.addFields({\n      currentPage: `Int!`,\n      hasPreviousPage: `Boolean!`,\n      hasNextPage: `Boolean!`,\n      itemCount: `Int!`,\n      pageCount: `Int!`,\n      perPage: `Int`,\n    })\n  })\n\nconst getEdge = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `Edge`\n  addDerivedType({ typeComposer, derivedTypeName: typeName })\n  return schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      next: typeComposer,\n      node: typeComposer.getTypeNonNull(),\n      previous: typeComposer,\n    })\n  })\n}\n\nconst createPagination = ({\n  schemaComposer,\n  typeComposer,\n  fields,\n  typeName,\n}) => {\n  const paginationTypeComposer = schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      totalCount: `Int!`,\n      edges: [getEdge({ schemaComposer, typeComposer }).getTypeNonNull()],\n      nodes: [typeComposer.getTypeNonNull()],\n      pageInfo: getPageInfo({ schemaComposer }).getTypeNonNull(),\n      ...fields,\n    })\n  })\n  paginationTypeComposer.makeFieldNonNull(`edges`)\n  paginationTypeComposer.makeFieldNonNull(`nodes`)\n  addDerivedType({ typeComposer, derivedTypeName: typeName })\n  return paginationTypeComposer\n}\n\nconst getGroup = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `GroupConnection`\n  const fields = {\n    field: `String!`,\n    fieldValue: `String`,\n  }\n  return createPagination({ schemaComposer, typeComposer, fields, typeName })\n}\n\nconst getPagination = ({ schemaComposer, typeComposer }) => {\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n  const typeName = typeComposer.getTypeName() + `Connection`\n  const fieldsEnumTC = getFieldsEnum({\n    schemaComposer,\n    typeComposer,\n    inputTypeComposer,\n  })\n  const fields = {\n    distinct: {\n      type: [`String!`],\n      args: {\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: distinct,\n    },\n    group: {\n      type: [getGroup({ schemaComposer, typeComposer }).getTypeNonNull()],\n      args: {\n        skip: `Int`,\n        limit: `Int`,\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: group,\n    },\n  }\n  const paginationTypeComposer = createPagination({\n    schemaComposer,\n    typeComposer,\n    fields,\n    typeName,\n  })\n  paginationTypeComposer.makeFieldNonNull(`distinct`)\n  paginationTypeComposer.makeFieldNonNull(`group`)\n  return paginationTypeComposer\n}\n\nmodule.exports = {\n  getPageInfo,\n  getEdge,\n  getGroup,\n  getPagination,\n}\n"],"file":"pagination.js"}